# Swarm-Ready Issue Template

> **Copy this template when creating new issues for autonomous agent execution**

---

## [BIF-XXX] [Action Verb] [Specific Component]

### Context (What & Why)
**Problem**: [1-2 sentence description of the problem or feature need]

**Impact**: [Why this matters - business value, technical debt reduction, etc.]

**Dependencies**: 
- [ ] None (standalone task)
- [ ] Requires: [List prerequisite BIF-XXX issues, or "None"]

---

### Acceptance Criteria (Machine-Readable)

```json
{
  "type": "code_change",
  "autonomy_level": "greenfield",
  "files_modified": [
    "path/to/primary/file.ts",
    "path/to/test/file.test.ts"
  ],
  "files_created": [],
  "files_deleted": [],
  "tests_required": true,
  "breaking_change": false,
  "hitl_approval": false,
  "verification": {
    "commands": [
      "npm run build",
      "npm test -- path/to/test/file.test.ts",
      "npm run lint"
    ],
    "expected_outcome": "All commands exit with 0, no errors"
  },
  "estimated_complexity": "simple"
}
```

**Autonomy Levels:**
- `greenfield`: Fully autonomous, no approval needed
- `supervised`: Autonomous execution, human review required
- `hitl`: Human-in-the-loop approval before execution
- `collaborative`: Requires human guidance throughout

**Complexity Levels:**
- `simple`: 1-3 files, < 100 LOC, clear requirements
- `moderate`: 4-10 files, < 500 LOC, some ambiguity
- `complex`: > 10 files or > 500 LOC, research needed

---

### Implementation Guide

> **For autonomous agents**: Follow these steps sequentially

#### Step 1: [Specific Action]
```bash
# Example command or code snippet
```
**Expected Result**: [What should happen]

#### Step 2: [Specific Action]
```bash
# Example command or code snippet
```
**Expected Result**: [What should happen]

#### Step 3: [Specific Action]
- [ ] Concrete sub-action with checkbox
- [ ] Another concrete sub-action
- [ ] Final sub-action

---

### Definition of Done

- [ ] **Code Quality**
  - [ ] Code compiles successfully (`npm run build`)
  - [ ] All existing tests pass
  - [ ] No new lint errors introduced
  - [ ] TypeScript types are correct (no `any` unless justified)

- [ ] **Testing**
  - [ ] Unit tests written for new functionality
  - [ ] Integration tests updated (if applicable)
  - [ ] Test coverage maintained or improved

- [ ] **Documentation**
  - [ ] JSDoc comments added to all exported functions
  - [ ] README updated (if public API changed)
  - [ ] CHANGELOG.md entry added

- [ ] **Verification**
  - [ ] All acceptance criteria commands run successfully
  - [ ] No breaking changes (or documented in PR)
  - [ ] Event logging instrumented (if applicable)

---

### Labels

Apply these labels when creating the issue:

- **Autonomy**: `sluagh:autonomous` or `sluagh:supervised` or `sluagh:hitl`
- **Type**: `type:feature` or `type:bug` or `type:refactor` or `type:docs`
- **Complexity**: `complexity:simple` or `complexity:moderate` or `complexity:complex`
- **Component**: `component:crypt-core` or `component:worker-bees` or `component:annals` etc.

---

### Agent Execution Checklist

> **Auto-generated by agent upon claiming task**

- [ ] Task claimed by agent: `[agent-id]` at `[timestamp]`
- [ ] Dependencies verified (all prerequisite tasks complete)
- [ ] Implementation started
- [ ] All implementation steps completed
- [ ] Tests written and passing
- [ ] Documentation updated
- [ ] Verification commands run successfully
- [ ] Pull request created (if applicable)
- [ ] Task moved to Review state

---

## Example Issue (Filled Out)

### [BIF-100] Add Event Count Endpoint to Annals of Ankou

#### Context
**Problem**: Need to query total event count for monitoring dashboards without retrieving full event history.

**Impact**: Reduces API overhead and enables real-time metrics display in Linear project trackers.

**Dependencies**: 
- [x] None (standalone feature)

#### Acceptance Criteria
```json
{
  "type": "code_change",
  "autonomy_level": "greenfield",
  "files_modified": [
    "workers/annals-of-ankou/src/index.ts"
  ],
  "files_created": [
    "workers/annals-of-ankou/src/index.test.ts"
  ],
  "files_deleted": [],
  "tests_required": true,
  "breaking_change": false,
  "hitl_approval": false,
  "verification": {
    "commands": [
      "cd workers/annals-of-ankou && npm run build",
      "cd workers/annals-of-ankou && npm test",
      "curl -X GET http://localhost:8889/events/count -H 'Authorization: Bearer dev-secret'"
    ],
    "expected_outcome": "Build successful, tests pass, API returns {\"count\": N}"
  },
  "estimated_complexity": "simple"
}
```

#### Implementation Guide

**Step 1: Add SQL Count Query**
```typescript
// In workers/annals-of-ankou/src/index.ts, add new endpoint handler
async handleCountRequest(): Promise<Response> {
  const result = await this.sql.exec("SELECT COUNT(*) as count FROM events");
  const count = result.rows[0][0];
  return new Response(JSON.stringify({ count }), {
    headers: { 'Content-Type': 'application/json' }
  });
}
```
**Expected Result**: Handler method exists

**Step 2: Wire Up Route**
```typescript
// In fetch() method, add:
case '/events/count':
  return await this.handleCountRequest();
```
**Expected Result**: Route added to switch statement

**Step 3: Add Tests**
- [ ] Create `workers/annals-of-ankou/src/index.test.ts`
- [ ] Test empty database returns `{"count": 0}`
- [ ] Test after inserting events returns correct count

#### Definition of Done
- [x] Code compiles
- [x] Tests pass
- [x] Endpoint returns correct count
- [x] Documentation updated

**Labels**: `sluagh:autonomous`, `type:feature`, `complexity:simple`, `component:annals`
