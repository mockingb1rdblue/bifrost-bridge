name = "crypt-core"
main = "src/index.ts"
compatibility_date = "2024-01-01"

[vars]
RATE_LIMIT_MAX_TOKENS = "100"
RATE_LIMIT_REFILL_RATE = "1"
RATE_LIMIT_DEGRADATION_THRESHOLD = "50"
LINEAR_PROJECT_ID = "9aeceb58-dc0e-46ab-9b26-f12c8a083815"
LINEAR_TEAM_ID = "d43e265a-cbc3-4f07-afcd-7792ce875ad3"

[[env.test.vars]]
RATE_LIMIT_MAX_TOKENS = "100"
RATE_LIMIT_REFILL_RATE = "1"
RATE_LIMIT_DEGRADATION_THRESHOLD = "50"
# Secrets should be loaded from .dev.vars for local testing
# PROXY_API_KEY
# LINEAR_API_KEY
# LINEAR_TEAM_ID
# LINEAR_PROJECT_ID
# GITHUB_APP_ID
# GITHUB_PRIVATE_KEY
# GITHUB_INSTALLATION_ID
# JULES_API_KEY
# DEEPSEEK_API_KEY
# ANTHROPIC_API_KEY
# GEMINI_API_KEY
# PERPLEXITY_API_KEY

[[env.test.durable_objects.bindings]]
name = "ROUTER_DO"
class_name = "RouterDO"

[[env.test.durable_objects.bindings]]
name = "GOVERNANCE_DO"
class_name = "GovernanceDO"

[[durable_objects.bindings]]
name = "ROUTER_DO"
class_name = "RouterDO"

[[durable_objects.bindings]]
name = "GOVERNANCE_DO"
class_name = "GovernanceDO"

[[migrations]]
tag = "v1"
new_sqlite_classes = ["RouterDO"]

[[migrations]]
tag = "v3"
deleted_classes = ["DullahanDispatcher"]

[[migrations]]
tag = "v4"
new_sqlite_classes = ["GovernanceDO"]

[triggers]
crons = ["0 8,20 * * *"] # Run at 08:00 and 20:00 UTC (Twice Daily)
